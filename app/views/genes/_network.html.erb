<script>
    var net=<%=@network.to_json.html_safe%>
    var i;

$(document).ready( function () {
          i=0;
         $('#gene_network_tbl').dataTable( {
             "sDom": "T<'clear'><'H'lfr>t<'F'ip>",
             "bJQueryUI": true,
             "sPaginationType": "full_numbers",
             "bPaginate": true,
             "oTableTools": {
                 "sSwfPath": 'assets/DataTables-1.9.4/extras/TableTools/media/swf/copy_csv_xls_pdf.swf',
                 "aButtons": [
                     {
                         "sExtends": "xls",
                         "sButtonText": "Save as Excel"
                     },
                     {
                         "sExtends": "pdf",
                         "sButtonText": "Save as PDF"
                     }
                 ]

             }
         } );
    var count= <%=@network.size%> ;

   if( count<300 )
    {
    $.each(net,function(index, value){
        $("#cloud_content").append("<li><a href='#' rel='20'>"+value.symbol2+"</a></li>");
        i++;
    });
   if(i<100) {
    $('#cloud').tagcloud({centrex:250,centrey:250,min_font_size: 8,
        max_font_size: 10, random_points: 50, zoom: 75, min_zoom: 10,
        max_zoom: 100, zoom_factor: 2  });

   }

    if(i>100 && i<300)  {
        $('#cloud').tagcloud({centrex:400,centrey:400,min_font_size: 8,
            max_font_size: 10, random_points: 50, zoom: 75, min_zoom: 10,
            max_zoom: 100, zoom_factor: 2  });
    }
    }
    else{
        $("#cloud").append( "<a href='#' onclick='createPopup()'>Network</a>");
    }

} );

  function createPopup(){
      var popup = open("", "Popup", "width=1500,height=1500");
      var script_1= popup.document.createElement('script');
      script_1.setAttribute("src", "/assets/jquery.js?body=1");
      script_1.setAttribute("type", "text/javascript");
      popup.document.head.appendChild(script_1);
      var script_2= popup.document.createElement('script');
      script_2.setAttribute("src", "/assets/jquery.mousewheel.min.js?body=1");
      script_2.setAttribute("type", "text/javascript");
      popup.document.head.appendChild(script_2);
      var script_3= popup.document.createElement('script');
      script_3.setAttribute("src", "/assets/jquery.tagsphere.js?body=1");
      script_3.setAttribute("type", "text/javascript");
      popup.document.head.appendChild(script_3);
      var script=popup.document.createElement('script');
      popup.document.head.appendChild(script);

      var div=popup.document.createElement('div');
      div.setAttribute("id", "cloud");
      var ul=popup.document.createElement('ul');
      div.appendChild(ul);

     $.each(net,function(index, value){
         var li = popup.document.createElement("li");
         li.innerHTML=("<a href='#' rel='20'>"+value.symbol2+"</a>");
         ul.appendChild(li);

      });
     // document.getElementsByTagName('div').append("</ul>");
      popup.document.body.appendChild(div);

      var cloud=document.getElementsByTagName('div');
      script.innerHTML=" $('#cloud').tagcloud({centrex:650,centrey:650,min_font_size: 8,max_font_size: 10, random_points: 50, zoom: 75, min_zoom: 10, max_zoom: 100, zoom_factor: 2 });";




  }


</script>
<div style="margin-top: 1%;">
  <% if @network.size>0 %>
 <h2>List of interactions for <%=network.at(1).symbol1%></h2>
  <% end %>
<table id="gene_network_tbl" class="display">
<thead>
  <tr>
    <th>Entrez ID of gene 1</th>
    <th>Entrez ID of gene 2</th>
    <th>Symbol of gene 1</th>
    <th>Symbol of gene 2</th>
  </tr>
</thead>
<tbody>
  <%network.each do |n| %>
      <tr>
        <td><%= n.id1 %></td>
        <td><%= n.id2 %></td>
        <td><%= n.symbol1 %></td>
        <td><%= n.symbol2 %></td>
      </tr>
  <% end %>
</tbody>
</table>
</div>
<h2>The interaction network</h2>
<div id="cloud" style="width:800px; height:800px;position:relative; overflow: hidden; margin: 0px; padding: 0px;">
  <ul id="cloud_content">  </ul>
</div></div>

